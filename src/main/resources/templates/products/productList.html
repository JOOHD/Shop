<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>상품 목록</title>
    <link rel="stylesheet" href="/css/fragments/header.css">
    <link rel="stylesheet" href="/css/productList.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

<!-- 헤더 -->
<div th:replace="~{fragments/header :: header}"></div>
<div class="overlay" onclick="toggleSidebar()"></div>

<!-- 카테고리 네비게이션 -->
<nav class="category-nav">
    <button class="category active">전체</button>
    <button class="category">상의</button>
    <button class="category">하의</button>
    <button class="category">아우터</button>
    <button class="category">용품</button>
</nav>

<!-- 필터 & 정렬 바 -->
<section class="filter-bar">
    <select>
        <option>인기순</option>
        <option>최신순</option>
        <option>낮은 가격순</option>
        <option>높은 가격순</option>
    </select>
    <button class="btn-filter">
        <i class="fas fa-sliders-h"></i> 필터
    </button>
</section>

<main class="product-list">
    <!-- DTO 기반 상품 반복 -->
    <article class="product-item" th:each="product : ${products}">
        <!-- 상세 페이지 링크 -->
        <a th:href="@{'/products/' + ${product.productId}}">
            <div class="thumbnail">
                <!-- 단일 썸네일 출력 -->
                <img th:src="@{${product.thumbnailUrl}}"
                     alt="상품 이미지"
                     class="thumbnail-image" />

                <!-- 할인 태그 -->
                <span class="tag" th:if="${product.isDiscount}">할인</span>
            </div>

            <div class="info">
                <!-- 가격 표시 -->
                <p class="price" th:if="${product.isDiscount}">
                    <span class="original-price" th:text="'₩' + ${#numbers.formatInteger(product.price, 0, 'COMMA')}">₩0</span>
                    <span class="discount-rate" th:text="${product.discountRate + '% 할인'}">10% 할인</span>
                    <span class="discounted-price"
                          th:text="'₩' + ${#numbers.formatInteger(product.price * (1 - product.discountRate / 100.0), 0, 'COMMA')}">₩0</span>
                </p>
                <p class="price" th:unless="${product.isDiscount}">
                    <span class="discount-price" th:text="'₩' + ${#numbers.formatInteger(product.price, 0, 'COMMA')}">₩0</span>
                </p>

                <!-- 상품명 -->
                <p class="name" th:text="${product.productName}">상품명</p>

                <!-- 등록일 표시 -->
                <p class="created-at" th:text="${#dates.format(product.createdAt, 'yyyy-MM-dd')}">등록일</p>
            </div>
        </a>
    </article>
</main>


<script>
    function toggleSidebar() {
        document.querySelector('.sidebar')?.classList.toggle('active');
        document.querySelector('.overlay')?.classList.toggle('active');
    }
</script>

</body>
</html>