<!DOCTYPE HTML>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Login Page</title>
    <script>
        async function login(event) {
            event.preventDefault(); // 폼 제출 막기

            const email = document.getElementById('email').value;
            const password = document.getElementById('password1').value;

            const response = await fetch('/login', {
                method: 'POST',
                headers: {'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });

            const text = await response.text();
            if (response.ok) {
                alert('success' + 로그인에 성공 했습니다.);
                window.location.href = '/'; // 로그인 성공 시 리디렉션
            } else {
                if (response.status == 401) {
                    alert('이메일 또는 비밀번호가 틀렸습니다.');
                } else {
                    alert('인증되지 않은 이메일 입니다.');
            }
        }
    </script>
</head>
<body>
<div th:replace="fragments/header :: header"></div>

<div class="container">
    <div>
        <h1>Login Page</h1>
    </div>
    <div>
        <!-- 이메일/비밀번호 로그인 폼 -->
        <form onsubmit="login(event)">
            <div class="form-group">
                <label for="email">이메일</label>
                <input id="email" type="email" class="form-control" placeholder="이메일을 입력하세요">
            </div>
            <div class="form-group">
                <label for="password1">비밀번호</label>
                <input id="password1" type="password" class="form-control" placeholder="비밀번호를 입력하세요">
            </div>
            <button type="submit" class="btn btn-primary">로그인</button>
        </form>

        <br/>

        <!-- 간편 로그인 영역 -->
        <div>
            <p>간편 로그인</p>
            <a href="/oauth2/authorization/kakao">
                <img src="/images/kakao_login_medium_narrow.png" alt="Kakao 로그인 버튼">
            </a>
            <a href="/oauth2/authorization/naver">
                <img src="/images/naver_login_medium_narrow.png" alt="Naver 로그인 버튼">
            </a>
        </div>
    </div>
</div>
</body>
</html>
